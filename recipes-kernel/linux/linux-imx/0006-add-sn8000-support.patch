From 8ef4f3e7a655270d8554e2ca6b0a931a849bd40e Mon Sep 17 00:00:00 2001
From: Stefano Gurrieri <stefano.gurrieri@roj.com>
Date: Wed, 6 Jul 2016 11:14:58 +0200
Subject: [PATCH] add-sn8000-support

---
 arch/arm/boot/dts/imx6qdl-roj-base.dtsi |  9 ++++++---
 arch/arm/boot/dts/imx6qdl-roj.dtsi      | 18 ++++++++++++++++--
 2 files changed, 22 insertions(+), 5 deletions(-)

diff --git a/arch/arm/boot/dts/imx6qdl-roj-base.dtsi b/arch/arm/boot/dts/imx6qdl-roj-base.dtsi
index 1d646f9..805bf82 100644
--- a/arch/arm/boot/dts/imx6qdl-roj-base.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-roj-base.dtsi
@@ -1623,7 +1623,8 @@
 				MX6QDL_PAD_SD4_DAT5__SD4_DATA5  0x17059
 				MX6QDL_PAD_SD4_DAT6__SD4_DATA6  0x17059
 				MX6QDL_PAD_SD4_DAT7__SD4_DATA7  0x17059
-				MX6QDL_PAD_NANDF_ALE__SD4_RESET 0x17059
+				MX6QDL_PAD_NANDF_ALE__GPIO6_IO08 0x17059
+				MX6QDL_PAD_EIM_D18__GPIO3_IO18   0x13069
 			>;
 		};
 
@@ -1639,7 +1640,8 @@
                                 MX6QDL_PAD_SD4_DAT5__SD4_DATA5  0x170B9
                                 MX6QDL_PAD_SD4_DAT6__SD4_DATA6  0x170B9
                                 MX6QDL_PAD_SD4_DAT7__SD4_DATA7  0x170B9
-                                MX6QDL_PAD_NANDF_ALE__SD4_RESET 0x170B9
+								MX6QDL_PAD_NANDF_ALE__GPIO6_IO08 0x170B9
+								MX6QDL_PAD_EIM_D18__GPIO3_IO18   0x13069
                         >;
                 };
 
@@ -1655,7 +1657,8 @@
                                 MX6QDL_PAD_SD4_DAT5__SD4_DATA5  0x170F9
                                 MX6QDL_PAD_SD4_DAT6__SD4_DATA6  0x170F9
                                 MX6QDL_PAD_SD4_DAT7__SD4_DATA7  0x170F9
-                                MX6QDL_PAD_NANDF_ALE__SD4_RESET 0x170F9
+								MX6QDL_PAD_NANDF_ALE__GPIO6_IO08 0x170F9
+								MX6QDL_PAD_EIM_D18__GPIO3_IO18   0x13069
                         >;
                 };
 
diff --git a/arch/arm/boot/dts/imx6qdl-roj.dtsi b/arch/arm/boot/dts/imx6qdl-roj.dtsi
index 7b0384c..caa3609 100644
--- a/arch/arm/boot/dts/imx6qdl-roj.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-roj.dtsi
@@ -91,6 +91,16 @@
 			enable-active-high;
 		};
 
+		/*wifi regulator*/
+		reg_wlreg_on: wlreg_on {
+			compatible = "regulator-fixed";
+			regulator-name = "wlreg_on";
+			regulator-min-microvolt = <3300000>;
+			regulator-max-microvolt = <3300000>;
+			gpio = <&gpio3 18 GPIO_ACTIVE_LOW>;
+			enable-active-low;
+		};
+
 		reg_sd1_vmmc: sd1_vmmc{
 			compatible = "regulator-fixed";
 			regulator-name = "P3V3_SDIO_SWITCHED";
@@ -276,7 +286,7 @@
 				MX6QDL_PAD_GPIO_2__GPIO1_IO02        0x80000000
 				MX6QDL_PAD_GPIO_6__GPIO1_IO06        0x80000000
 				MX6QDL_PAD_GPIO_17__GPIO7_IO12       0x80000000
-                               MX6QDL_PAD_GPIO_18__GPIO7_IO13       0x80000000
+                MX6QDL_PAD_GPIO_18__GPIO7_IO13       0x80000000
 				MX6QDL_PAD_NANDF_D0__GPIO2_IO00      0x80000000
 				MX6QDL_PAD_NANDF_D1__GPIO2_IO01      0x80000000
 				MX6QDL_PAD_NANDF_D2__GPIO2_IO02      0x80000000
@@ -293,7 +303,6 @@
 				MX6QDL_PAD_EIM_DA13__GPIO3_IO13      0x80000000
 				MX6QDL_PAD_EIM_DA14__GPIO3_IO14      0x80000000
 				MX6QDL_PAD_EIM_DA15__GPIO3_IO15      0x80000000
-				MX6QDL_PAD_EIM_D18__GPIO3_IO18       0x80000000
 				MX6QDL_PAD_EIM_D30__GPIO3_IO30       0x80000000
 				MX6QDL_PAD_EIM_D31__GPIO3_IO31       0x80000000
 				MX6QDL_PAD_GPIO_19__GPIO4_IO05       0x80000000
@@ -468,10 +477,15 @@
         pinctrl-0 = <&pinctrl_usdhc4_1>;
         pinctrl-1 = <&pinctrl_usdhc4_1_100mhz>;
         pinctrl-2 = <&pinctrl_usdhc4_1_200mhz>;
+		vmmc-supply = <&reg_wlreg_on>;
         bus-width = <4>;
         no-1-8-v;
         non-removable;
         keep-power-in-suspend;
         enable-sdio-wakeup;
         status = "okay";
+
+		brcmf: bcrmf@1 {
+			compatible = "brcm,bcm4329-fmac";
+		};
 };
-- 
1.9.1

