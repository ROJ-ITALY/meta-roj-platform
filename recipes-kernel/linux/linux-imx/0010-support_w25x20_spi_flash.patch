From dd207055c8f063fcba05f09cd63140a7f230b6cf Mon Sep 17 00:00:00 2001
From: Stefano Gurrieri <stefano.gurrieri@roj.com>
Date: Tue, 27 Jun 2017 14:05:26 +0200
Subject: [PATCH] support_w25x20_spi_flash

---
 arch/arm/boot/dts/imx6qdl-roj-base.dtsi |  4 ++--
 arch/arm/boot/dts/imx6qdl-roj.dtsi      | 13 +++++++++++++
 2 files changed, 15 insertions(+), 2 deletions(-)

diff --git a/arch/arm/boot/dts/imx6qdl-roj-base.dtsi b/arch/arm/boot/dts/imx6qdl-roj-base.dtsi
index e8118d5..c3de3b6 100644
--- a/arch/arm/boot/dts/imx6qdl-roj-base.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-roj-base.dtsi
@@ -1279,8 +1279,8 @@
 	ecspi4 {
 		pinctrl_ecspi4_cs_1: ecspi4_cs_grp-1 {
 			fsl,pins = <
-				MX6QDL_PAD_EIM_D29__ECSPI4_SS0 0x100b1
-				MX6QDL_PAD_EIM_A25__ECSPI4_SS1 0x100b1
+				MX6QDL_PAD_EIM_D29__GPIO3_IO29 0x100b1
+				MX6QDL_PAD_EIM_A25__GPIO5_IO02 0x100b1
 			>;
 		};
 
diff --git a/arch/arm/boot/dts/imx6qdl-roj.dtsi b/arch/arm/boot/dts/imx6qdl-roj.dtsi
index 19eb8d0..01c195b 100644
--- a/arch/arm/boot/dts/imx6qdl-roj.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-roj.dtsi
@@ -207,6 +207,19 @@
 	cs-gpios = <&gpio3 29 0 &gpio5 2 0>;
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_ecspi4_1 &pinctrl_ecspi4_cs_1>;
+	status = "okay";
+
+	flash@0 {
+		compatible = "w25x20", "jedec,spi-nor";
+		spi-max-frequency = <20000000>;
+		reg = <0>;
+	};
+
+	flash@1 {
+		compatible = "w25x20", "jedec,spi-nor";
+		spi-max-frequency = <20000000>;
+		reg = <1>;
+	};
 };
 
 &esai {
-- 
1.9.1

